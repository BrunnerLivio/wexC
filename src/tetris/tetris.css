@import "scene3D/scene.css";

:root {
    --unit:      1cqmin;
    --box-width: calc( 6 * var(--unit));

}

html {
    overscroll-behavior:    none;
    font-family:            system-ui;
}

header {
    position:               fixed;
    z-index:                10;
    inset:                  1em 1em auto auto;
    background-color:       #FFF2;
    padding:                .5em 1em;
    border-radius:          .5em;
    color:                  aliceblue;
    color-scheme:           dark;

    display:                grid;
    grid-template-columns:  1fr;
    gap:                    .3em;
    justify-items:          right;

    &.active {
        border:             2px solid white;
    }

    & div.playerList {
        padding:            .3em .5em;
        background-color:   #FFFFFF18;
        border-radius:      .3em;

        & ul {
            overflow-y:      scroll;
            max-height:      5lh;
            max-width:       10ch;
            list-style:      none;
            padding:         0;
            margin:          0;
            & li {
                text-wrap:   nowrap;
            }
        }
    }
}
li.active {
    text-decoration: underline;
}

body {
    min-height:             100dvh;
    display:                grid;
    grid-template-columns:  100%;
    grid-template-rows:     1fr max-content;
    margin:                 0;
    background:             linear-gradient(in srgb-linear, blue, orange);
}

footer {
    padding:     1lh;
    display:     grid;
    place-items: center;
    color:       white;
    font-size:   120%;
}

.floor {
    position:         absolute;
    inset:            0;
    width:            100%;
    height:           100%;
    background-image: repeating-conic-gradient(transparent 0deg 90deg, black 90deg 180deg);
    background-size:  calc(var(--box-width) * 2)
                      calc(var(--box-width) * 2);
    opacity:          0.3;

    & .toplight {
        position:         absolute;
        inset:            0;
        background-image: radial-gradient(white 30%, black 80%);
        opacity:          .85;
    }
}

.tetromino {
    transform-style: preserve-3d;
    color:           transparent; /* avoid spiky artefacts */
    grid-area:       1/1;
    display:         grid;
    --z-center:      calc(var(--box-width) / 2);
    transform:       translateZ(var(--z-center)); /* or we would be half-a-box size too low */
}

/* provides the logical group */
.box {
    grid-area:       1/1;
    --x:             0;
    --y:             0;
    --z:             12;
    width:           var(--box-width);
    aspect-ratio:    1 / 1;
    display:         grid; /* child positioning (the faces) */
    transform-style: preserve-3d; /* put children in our 3d space */
    translate:       calc(var(--x) * var(--box-width))
                     calc(var(--y) * var(--box-width))
                     calc(var(--z) * var(--box-width));
    transition:      all .1s ease-in-out;
}
.tetromino.ghost .box {
    --z:            0;
}

.box.destroy {
    scale:          10;
    translate:      calc(var(--x) * var(--box-width))
                    calc(var(--y) * var(--box-width))
                    calc((-1/2)   * var(--box-width));
    transition:     translate .7s     cubic-bezier(1, 0.7, 1, 1),
                    scale     .6s .6s ease-out;
}

.box.destroy .face {
    opacity:        0;
    filter:         blur(.2cqmin);
    transform:      rotateY(0deg) rotateX(0deg);
    transition:     transform  1s .4s linear,
                    opacity   .5s  1s linear,
                    filter    .6s .5s linear;
}


/* all children (faces) go directly on top of each other */
.face {
    grid-area:     1/1;
    background:    grey;
    opacity:       .8;
    border-radius: 3%;
    border:        1px solid #C9FF;
}

/* the transform origin for rotate is center by default, so rotations must first */
/* put the respective face in the the center, then rotate.            */
.face:nth-child(1) {
    transform: translateZ(var(--z-center));
}

/* move front to center */
.face:nth-child(2) {
    transform: rotateY(180deg) translateZ(var(--z-center));
}

/* center, then around Y-axis to the back */
.face:nth-child(3) {
    transform: rotateY(-90deg) translateZ(var(--z-center));
}

/* center, then around Y-axis to the left */
.face:nth-child(4) {
    transform: rotateY(90deg) translateZ(var(--z-center));
}

/* center, then around Y-axis to the right */
.face:nth-child(5) {
    transform: rotateX(90deg) translateZ(var(--z-center));
}

/* center, then around X-axis to the top */
.face:nth-child(6) {
    transform: rotateX(-90deg) translateZ(var(--z-center));
}

/* center, then around X-axis to the bottom */


.charI      .face {background-color: cyan;}
.charT      .face {background-color: red;}
.charO      .face {background-color: blueviolet;}
.charS      .face {background-color: yellow;}
.charZ      .face {background-color: lime;}
.charL      .face {background-color: orange;}
.charF      .face {background-color: white;}
.branch     .face {background-color: magenta;}
.screwRight .face {background-color: yellow;}
.screwLeft  .face {background-color: lime;}

.ghost .face  {
    background-color: transparent;
    border:           none;
}

.ghost.show .face:nth-child(2) { /* floor face */
    background-color: yellow;
    box-shadow:       0 0 3cqmin yellow;
    opacity:          1;
}

.plane {
    border: 4px solid #99Fe;

    &.show {
        background: #99F9;
    }
}

.yz-plane {
    transform-origin: left top;
    transform:        rotateY(-90deg);
}

/* Axis Control Styles */
:root {
  --axis-control-color: #ff74d4;
  --axis-button-bg: #1a0d2e;
  --axis-button-active: #ff74d4;
  --axis-frame-color: #ff74d4;
}

.axis-control {
  position: fixed;
  inset: 6.5em 1.6em auto auto;
  z-index: 12;
  display: grid;
  gap: 0.6em;
  color: var(--axis-control-color);
  pointer-events: none;
}

.axis-control[data-in-charge="other"] .axis-frame {
  opacity: 0.7;
}

.axis-frame {
  padding: 0.9em;
  border-radius: 1.5em;
  background: linear-gradient(135deg, #1a0d2e 0%, #2a1d4e 100%);
  box-shadow: 0 8px 32px rgba(255, 116, 212, 0.15),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);
  display: grid;
  place-items: center;
  transition: opacity 0.2s ease-out;
  pointer-events: auto;
}

.axis-buttons {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0.5em;
  width: 100%;
}

.axis-button {
  position: relative;
  padding: 0.8em 1em;
  background: var(--axis-button-bg);
  border: 2px solid rgba(255, 116, 212, 0.3);
  border-radius: 0.8em;
  color: var(--axis-control-color);
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s ease;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.2em;
  min-width: 3.5em;
  touch-action: manipulation;
  user-select: none;
}

.axis-button:hover {
  background: linear-gradient(135deg, #2a1d4e 0%, #3a2d6e 100%);
  border-color: rgba(255, 116, 212, 0.6);
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(255, 116, 212, 0.3);
}

.axis-button:active,
.axis-button.active {
  transform: scale(0.95);
  background: linear-gradient(135deg, #ff74d4 0%, #d45fb5 100%);
  border-color: var(--axis-button-active);
  color: white;
  box-shadow: 0 0 20px rgba(255, 116, 212, 0.6),
    inset 0 0 10px rgba(255, 255, 255, 0.3);
}

.axis-button.rotating {
  animation: axis-button-blink 0.3s ease-in-out;
}

@keyframes axis-button-blink {
  0%, 100% {
    border-color: rgba(255, 116, 212, 0.3);
    box-shadow: none;
  }
  50% {
    border-color: var(--axis-button-active);
    box-shadow: 0 0 20px rgba(255, 116, 212, 0.8),
      inset 0 0 10px rgba(255, 116, 212, 0.4);
  }
}

.axis-label {
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  opacity: 0.8;
}

.axis-symbol {
  font-size: 1.3rem;
  line-height: 1;
}

.axis-button:nth-child(2n) .axis-label {
  display: none;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .axis-control {
    inset: auto 1em 1em auto;
  }
  
  .axis-button {
    padding: 0.6em 0.8em;
    min-width: 3em;
  }
  
  .axis-symbol {
    font-size: 1.1rem;
  }
}
